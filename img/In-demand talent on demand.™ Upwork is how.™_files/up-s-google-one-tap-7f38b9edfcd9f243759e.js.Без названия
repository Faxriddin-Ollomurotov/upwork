(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{1602:function(t,e,o){"use strict";o.r(e);var n=function(t,e,o){o("impression","show_widget"),window.google.accounts.id.initialize({client_id:t,callback:t=>{e(t.credential)},cancel_on_tap_outside:!1}),window.google.accounts.id.prompt()};o(7);var r=function(t){const form=document.createElement("form");form.method="post",form.action="/ab/account-security/sso",Object.entries({id_token:t,state:"?ssoProvider=google"}).forEach(([t,e])=>{const input=document.createElement("input");input.name=t,input.value=e,form.appendChild(input)}),document.body.appendChild(form),form.submit()};let c;var l={methods:{trackEvent(t){const e="page"===t.event?["olog"]:["olog","snowplow"];return this.$tracker.track({...t,trackers:e})},async logEvent(t){const e={...t};var o;o="id",{}.hasOwnProperty.call(t.data||{},o)&&(e.data.id=this.$store.state.context.user.uid),await this.trackEvent(e)},async logImpressionEvent(t,e){!c&&e&&(await this.logEvent(e),c=!0),await this.logEvent(t)},extendLogData:(t,data)=>({...t,data:{...t.data||{},...data}})}},d=o(0),h={mixins:[Object(d.a)(l,void 0,void 0,!1,null,null,null).exports],props:{clientId:{type:String,required:!0}},methods:{authorize(t){this.processGoogleOneTapUser(t)},logWidget(t,label){this.logEvent({event:t,sublocation:"one_tap_sign_up",label:label})},async processGoogleOneTapUser(t){const e=await this.$iovation.bbPromise;await this.signUpWithOneTap(t,e)},async signUpWithOneTap(t,e){const{login:o,redirectTo:n}=await this.authorizeWithOneTap(t);if(o){const n=await this.logIn(e,o,t);if(!n)return;const{success:c,mode:l}=n;if(!c&&"password"===l)return void r(t);this.logWidget("click","existing_user_with_one_tap"),window.location.href="/signup/home/"}else n&&(this.logWidget("click","new_user_with_one_tap"),window.location.href=n)},authorizeWithOneTap(t){return this.$http({handleApiErrors:!1}).url("/signup/one-tap-redirect-url?credential=".concat(encodeURI(t))).get().json()},logIn(t,e,o){return this.$http({handleApiErrors:!1}).url("/ab/account-security/login").get().json().then(({fields:n,redirectUrl:r})=>{if(!n)return r&&(window.location.href=r),!1;const c={};return c[n.mode]="sso",c[n.iovation]=t,c[n.sso_user_data]={email:e,authResponse:{id_token:o},provider:"google"},this.$http({handleApiErrors:!1}).url("/ab/account-security/login").post(c).json()})}},head(){return{script:[{hid:"google-qsi-client",src:"https://accounts.google.com/gsi/client",defer:!0,callback:()=>{n(this.clientId,this.authorize,this.logWidget)}}]}}},w=Object(d.a)(h,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,null,null);e.default=w.exports}}]);